<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0f14" />
  <title>PerformanceIQ</title>
  <link rel="icon" href="./icon-192.png" />
  <link rel="apple-touch-icon" href="./icon-192.png" />
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <!-- Splash -->
  <div id="splash" class="splash" aria-hidden="false">
    <div class="splash-card">
      <div class="brand">
        <div class="logo-dot"></div>
        <div>
          <div class="brand-title">PerformanceIQ</div>
          <div class="brand-sub">Offline-first • Team-ready</div>
        </div>
      </div>

      <div class="splash-loading">
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div id="splashText" class="muted small" style="margin-top:10px">Preparing your workspace…</div>
      </div>
    </div>
  </div>

  <!-- Topbar -->
  <header class="topbar">
    <div class="topbar-left">
      <div class="appmark">
        <span class="appmark-dot" aria-hidden="true"></span>
        <span class="appmark-title">PerformanceIQ</span>
      </div>

      <span class="pill" id="savePill" title="Save status">
        <span class="dot" id="saveDot"></span>
        <span id="saveText">Saved</span>
      </span>

      <span class="pill" id="teamPill" title="Active team">Team: —</span>
      <span class="pill" id="cloudPill" title="Cloud status">Cloud: Local</span>

      <button class="iconbtn" id="btnThemeToggle" title="Toggle dark/light">☾</button>
    </div>

    <div class="topbar-right">
      <button class="btn ghost" id="btnHelp">Help</button>
      <button class="btn" id="btnAccount">Account</button>
    </div>
  </header>

  <!-- Layout -->
  <main class="layout">
    <!-- Desktop nav -->
    <nav class="nav" role="navigation" aria-label="Primary" id="desktopNav">
      <button class="navbtn" data-view="home">Home</button>
      <button class="navbtn" data-view="team">Team</button>
      <button class="navbtn" data-view="train">Train</button>
      <button class="navbtn" data-view="profile">Profile</button>
    </nav>

    <!-- Content -->
    <section class="content">
      <section class="view" id="view-home" data-view>
        <div class="card">
          <div class="row between" style="gap:10px;flex-wrap:wrap">
            <div>
              <div class="card-title">Home</div>
              <div class="small muted" id="homeSub">Welcome back.</div>
            </div>
            <div class="row gap wrap">
              <button class="btn" id="todayButton">Generate → Start → Log</button>
              <span class="pill" id="todayTimer">No timer running</span>
              <button class="iconbtn" id="tipToday" title="Help">?</button>
            </div>
          </div>

          <div class="grid2" style="margin-top:12px">
            <div class="mini">
              <div class="row between">
                <div class="minihead">Today</div>
                <button class="iconbtn" id="tipQuick" title="Help">?</button>
              </div>
              <div class="minibody" id="todayBlock">—</div>
            </div>

            <div class="mini">
              <div class="row between">
                <div class="minihead">Quick actions</div>
                <button class="iconbtn" id="tipTrain" title="Help">?</button>
              </div>
              <div class="row gap wrap">
                <button class="btn" id="qaTrain">Open Train</button>
                <button class="btn ghost" id="qaTeam">Manage Team</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="view" id="view-team" data-view hidden>
        <div class="card">
          <div class="row between">
            <div>
              <div class="card-title">Team</div>
              <div class="small muted">Roster, join codes, and access.</div>
            </div>
            <button class="iconbtn" id="tipTeam" title="Help">?</button>
          </div>
          <div id="teamBody" style="margin-top:12px"></div>
        </div>
      </section>

      <section class="view" id="view-train" data-view hidden>
        <div class="card">
          <div class="row between">
            <div>
              <div class="card-title">Train</div>
              <div class="small muted" id="trainSub">Workouts tailored to the selected sport.</div>
            </div>
            <button class="iconbtn" id="tipTrain2" title="Help">?</button>
          </div>
          <div id="trainBody" style="margin-top:12px"></div>
        </div>
      </section>

      <section class="view" id="view-profile" data-view hidden>
        <div class="card">
          <div class="row between">
            <div>
              <div class="card-title">Profile</div>
              <div class="small muted">Your role, sport, preferences, reports, periodization, and insights.</div>
            </div>
            <button class="iconbtn" id="tipProfile" title="Help">?</button>
          </div>
          <div id="profileBody" style="margin-top:12px"></div>
        </div>
      </section>
    </section>
  </main>

  <!-- Mobile bottom nav -->
  <nav class="bottomnav" id="bottomNav" aria-label="Bottom Navigation">
    <button class="tab" data-view="home"><span class="tablbl">Home</span></button>
    <button class="tab" data-view="team"><span class="tablbl">Team</span></button>
    <button class="tab" data-view="train"><span class="tablbl">Train</span></button>
    <button class="tab" data-view="profile"><span class="tablbl">Profile</span></button>
  </nav>

  <!-- FAB + sheet -->
  <button class="fab" id="fab" aria-label="Quick add">+</button>
  <div class="sheet-backdrop" id="sheetBackdrop" hidden></div>
  <div class="sheet" id="fabSheet" hidden>
    <div class="sheet-head">
      <div class="sheet-title">Quick log</div>
      <button class="btn ghost" id="btnCloseSheet">Close</button>
    </div>
    <div class="sheet-body">
      <button class="btn" id="fabLogWorkout">Log workout</button>
      <button class="btn ghost" id="fabLogNutrition">Log nutrition</button>
      <button class="btn ghost" id="fabLogWellness">Log wellness</button>
    </div>
  </div>

  <!-- Account Drawer -->
  <div class="drawer-backdrop" id="drawerBackdrop" hidden></div>
  <aside class="drawer" id="accountDrawer" aria-hidden="true">
    <div class="drawer-head">
      <div>
        <div class="drawer-title">Account</div>
        <div class="small muted">Preferences • appearance • data management • cloud (optional)</div>
      </div>
      <button class="btn ghost" id="btnCloseDrawer">Close</button>
    </div>

    <div class="drawer-body">
      <!-- Role & Sport -->
      <div class="card subtle">
        <div class="card-title">Role & Sport</div>
        <div class="grid2" style="margin-top:10px">
          <div class="field">
            <label>Role</label>
            <select id="roleSelect">
              <option value="coach">Coach</option>
              <option value="athlete">Athlete</option>
              <option value="parent">Parent</option>
            </select>
          </div>

          <div class="field">
            <label>Sport</label>
            <select id="sportSelect">
              <option value="basketball">Basketball</option>
              <option value="football">Football</option>
              <option value="soccer">Soccer</option>
              <option value="baseball">Baseball</option>
              <option value="volleyball">Volleyball</option>
              <option value="track">Track</option>
            </select>
          </div>
        </div>

        <div class="field" style="margin-top:10px">
          <label>Preferred session type</label>
          <select id="preferredSessionSelect">
            <option value="strength">Strength</option>
            <option value="speed">Speed</option>
            <option value="conditioning">Conditioning</option>
            <option value="skill">Skill</option>
            <option value="recovery">Recovery</option>
          </select>
        </div>

        <div class="row gap wrap" style="margin-top:10px">
          <button class="btn" id="btnSaveProfile">Save</button>
          <button class="btn ghost" id="btnRunTour">Tour this tab</button>
        </div>
      </div>

      <!-- Appearance -->
      <div class="card subtle" style="margin-top:12px">
        <div class="card-title">Appearance (Phase 2)</div>
        <div class="grid2" style="margin-top:10px">
          <div class="field">
            <label>Mode</label>
            <select id="themeModeSelect">
              <option value="dark">Dark</option>
              <option value="light">Light</option>
            </select>
          </div>
          <div class="field">
            <label>Accent sport</label>
            <select id="themeSportSelect">
              <option value="basketball">Basketball</option>
              <option value="football">Football</option>
              <option value="soccer">Soccer</option>
              <option value="baseball">Baseball</option>
              <option value="volleyball">Volleyball</option>
              <option value="track">Track</option>
            </select>
          </div>
        </div>
        <div class="row gap wrap" style="margin-top:10px">
          <button class="btn" id="btnSaveTheme">Save theme</button>
        </div>
      </div>

      <!-- Data Management (Phase 0/1 trust) -->
      <div class="card subtle" style="margin-top:12px">
        <div class="card-title">Data Management</div>
        <div class="small muted">Export/Import/Reset are here (not in header). Undo is offered for risky actions.</div>

        <div class="row gap wrap" style="margin-top:10px">
          <button class="btn ghost" id="btnExport">Export JSON</button>
          <label class="btn ghost" style="cursor:pointer">
            Import JSON
            <input id="fileImport" type="file" accept="application/json" style="display:none" />
          </label>
          <button class="btn danger" id="btnResetLocal">Reset local</button>
        </div>

        <div class="row gap wrap" style="margin-top:10px">
          <button class="btn" id="btnRunGrade">Run QA Grade</button>
        </div>

        <div class="small muted" id="dataMsg" style="margin-top:8px">—</div>
        <pre id="gradeReport" class="small muted" style="white-space:pre-wrap;margin-top:8px">—</pre>
      </div>

      <!-- Cloud placeholder -->
      <div class="card subtle" style="margin-top:12px">
        <div class="card-title">Cloud (optional)</div>
        <div class="small muted">This build focuses Phase 2–3 offline stability. Cloud is reintroduced later.</div>
        <div class="small muted" style="margin-top:8px">—</div>
      </div>
    </div>
  </aside>

  <!-- Help Drawer -->
  <div class="drawer-backdrop" id="helpBackdrop" hidden></div>
  <aside class="drawer drawer-help" id="helpDrawer" aria-hidden="true">
    <div class="drawer-head">
      <div>
        <div class="drawer-title">Help</div>
        <div class="small muted">Searchable guidance (Ctrl/⌘+K)</div>
      </div>
      <button class="btn ghost" id="btnCloseHelp">Close</button>
    </div>
    <div class="drawer-body">
      <div class="field">
        <label>Search</label>
        <input id="helpSearch" type="text" placeholder="Try: today, session types, injury, report, periodization..." />
      </div>
      <div id="helpResults" style="margin-top:10px"></div>
    </div>
  </aside>

  <!-- Toasts -->
  <div class="toast" id="toast" hidden></div>
  <div id="undoToast" hidden></div>

  <script src="./dataStore.js"></script>
  <script src="./nutritionEngine.js"></script>
  <script src="./periodizationEngine.js"></script>
  <script src="./core.js"></script>
</body>
</html>
