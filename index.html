<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PerformanceIQ</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="favicon.ico">
</head>
<body>

<!-- LOADING SCREEN -->
<div id="loadingScreen" style="
  position:fixed;inset:0;z-index:9999;
  display:flex;align-items:center;justify-content:center;
  background:radial-gradient(900px 600px at 50% -10%, rgba(255,255,255,0.06), transparent 55%), #070b12;
  color:#eaf0ff;
">
  <div style="display:flex;flex-direction:column;align-items:center;gap:10px;text-align:center;padding:24px;">
    <div style="display:flex;align-items:center;gap:10px;">
      <div style="width:12px;height:12px;border-radius:50%;background:rgba(16,42,79,.95);box-shadow:0 0 0 6px rgba(16,42,79,.18)"></div>
      <div style="font-weight:800;letter-spacing:.06em">PerformanceIQ</div>
    </div>
    <div style="font-size:12px;opacity:.78;letter-spacing:.03em">Loading dashboard‚Ä¶</div>
  </div>
</div>

<header class="topbar">
  <div class="topbar-left">
    <div class="brand-mark"><div class="brand-dot"></div></div>
    <span class="brand-name">PerformanceIQ</span>
  </div>

  <div class="topbar-center">
    <div class="pill live" id="pillOnline"><span class="pulse"></span><span id="pillOnlineText">Team Online</span></div>
    <div class="pill" id="pillSeason">Pre-Season</div>
    <div class="pill orange" id="pillGame" style="display:none">‚ö° <span id="pillGameText"></span></div>
  </div>

  <div class="topbar-right">
    <div class="search-wrap">
      <span class="search-icon">üîç</span>
      <input class="search-input" type="text" placeholder="Search athletes‚Ä¶" id="athleteSearch" />
    </div>
    <button class="icon-btn" id="btnTheme" title="Toggle theme">üåô</button>
    <button class="icon-btn" id="btnRefresh" title="Refresh data">‚Ü∫</button>
    <button class="icon-btn" id="btnExport" title="Export report">üì§</button>
  </div>
</header>

<div class="app-shell">
  <nav class="sidebar">
    <div class="sidebar-section">Main</div>
    <button class="nav-btn active" data-view="dashboard"><i class="nav-icon">‚¨°</i> Dashboard</button>
    <button class="nav-btn" data-view="athletes"><i class="nav-icon">‚óâ</i> Athletes <span class="nav-badge" id="riskBadge" style="display:none">0</span></button>
    <button class="nav-btn" data-view="train"><i class="nav-icon">‚ñ∑</i> Train</button>
    <button class="nav-btn" data-view="analytics"><i class="nav-icon">‚óà</i> Analytics</button>

    <div class="sidebar-section">Manage</div>
    <button class="nav-btn" data-view="schedule"><i class="nav-icon">üìÖ</i> Schedule</button>
    <button class="nav-btn" data-view="wellness"><i class="nav-icon">üåô</i> Wellness</button>
    <button class="nav-btn" data-view="nutrition"><i class="nav-icon">ü•ó</i> Nutrition</button>
    <button class="nav-btn" data-view="settings"><i class="nav-icon">‚öô</i> Settings</button>

    <div class="sidebar-bottom">
      <div class="user-block" id="userBlock">
        <div class="user-avatar" id="userAv">CD</div>
        <div>
          <div class="user-name" id="userName">Coach Davis</div>
          <div class="user-role" id="userRole">Head Coach ¬∑ Basketball</div>
        </div>
      </div>
    </div>
  </nav>

  <main class="main-content">

    <!-- DASHBOARD VIEW -->
    <section class="view active" id="view-dashboard">
      <div class="section-head">
        <div>
          <h1 class="page-title">Command Center</h1>
          <div class="page-sub" id="dashSub">Today ¬∑ Team Overview</div>
        </div>
        <div class="chips">
          <div class="chip live"><span class="pulse"></span><span id="chipOnlineText">0 online</span></div>
          <div class="chip warn" id="chipFlags" style="display:none"><span>‚ö†</span><span id="chipFlagsText">0 flags</span></div>
          <div class="chip orange" id="chipGame" style="display:none"><span>‚ö°</span><span id="chipGameText2"></span></div>
        </div>
      </div>

      <div class="grid stats-grid">
        <div class="stat-card accent">
          <div class="stat-label">Team Avg PIQ</div>
          <div class="stat-value" id="statAvg">‚Äî</div>
          <div class="stat-sub" id="statAvgSub">‚Äî</div>
          <div class="sparkline" id="sparkAvg"></div>
        </div>

        <div class="stat-card green">
          <div class="stat-label">Ready</div>
          <div class="stat-value" id="statReady">0</div>
          <div class="stat-sub" id="statReadySub">‚Äî</div>
        </div>

        <div class="stat-card yellow">
          <div class="stat-label">Monitor</div>
          <div class="stat-value" id="statMonitor">0</div>
          <div class="stat-sub" id="statMonitorSub">‚Äî</div>
        </div>

        <div class="stat-card red">
          <div class="stat-label">High Risk</div>
          <div class="stat-value" id="statRisk">0</div>
          <div class="stat-sub">Today</div>
        </div>
      </div>

      <div class="grid two-col">
        <div class="card">
          <div class="card-head">
            <div class="card-title">Team Heatmap</div>
            <div class="card-actions">
              <button class="btn btn-ghost btn-sm">View all ‚Üí</button>
            </div>
          </div>
          <div class="table-wrap">
            <table class="table">
              <thead>
              <tr>
                <th>Athlete</th>
                <th>PIQ</th>
                <th>Readiness</th>
                <th>ACWR</th>
                <th>Risk</th>
                <th>Trend</th>
              </tr>
              </thead>
              <tbody id="heatmapBody"></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Risk Alerts</div>
          </div>
          <div class="card-body" id="alertsList"></div>
        </div>
      </div>

      <div class="grid three-col">
        <div class="card">
          <div class="card-head">
            <div class="card-title">Load Distribution</div>
          </div>
          <div class="card-body" id="loadBarList"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Roster Snapshot</div>
          </div>
          <div class="card-body" id="rosterMini"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Activity Feed</div>
          </div>
          <div class="card-body" id="activityFeed"></div>
        </div>
      </div>

      <div class="grid two-col">
        <div class="card">
          <div class="card-head">
            <div class="card-title">Upcoming Events</div>
          </div>
          <div class="card-body" id="eventList"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Coach Insight</div>
          </div>
          <div class="card-body">
            <div id="insightText"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ATHLETES VIEW -->
    <section class="view" id="view-athletes">
      <div class="section-head">
        <div>
          <h1 class="page-title">Athletes</h1>
          <div class="page-sub" id="athleteCountSub">‚Äî</div>
        </div>
        <div class="actions">
          <input id="athleteFilterInput" class="input" placeholder="Filter roster‚Ä¶" />
          <button class="btn btn-primary">+ Add Athlete</button>
        </div>
      </div>

      <div class="grid cards-grid" id="athleteCardGrid"></div>

      <div class="athlete-detail" id="athleteDetail" style="display:none">
        <button class="btn btn-ghost btn-sm" id="backToList">‚Üê Back</button>

        <div class="card">
          <div class="card-body">
            <div class="detail-hero" id="detailHero"></div>
          </div>
        </div>

        <div class="grid two-col">
          <div class="card">
            <div class="card-head">
              <div class="card-title">PIQ Score</div>
            </div>
            <div class="card-body">
              <div class="ring-wrap">
                <svg class="ring" viewBox="0 0 160 160">
                  <circle class="ring-track" cx="80" cy="80" r="70"></circle>
                  <circle class="ring-fill" id="detailRingFill" cx="80" cy="80" r="70"></circle>
                </svg>
                <div class="ring-center">
                  <div class="ring-number" id="detailRingNum">‚Äî</div>
                  <div class="ring-delta" id="detailRingDelta"></div>
                </div>
              </div>
              <div class="score-tier" id="detailTier"></div>
              <div class="note" id="detailScoreNote"></div>
            </div>
          </div>

          <div class="card">
            <div class="card-head">
              <div class="card-title">Pillars</div>
            </div>
            <div class="card-body pillars" id="detailPillars"></div>
          </div>
        </div>

        <div class="grid three-col">
          <div class="card">
            <div class="card-head">
              <div class="card-title">Wellness</div>
            </div>
            <div class="card-body" id="detailWellness"></div>
          </div>

          <div class="card">
            <div class="card-head">
              <div class="card-title">Load (ACWR)</div>
            </div>
            <div class="card-body" id="detailLoad"></div>
          </div>

          <div class="card">
            <div class="card-head">
              <div class="card-title">Coach Insight</div>
            </div>
            <div class="card-body" id="detailInsight"></div>
          </div>
        </div>

        <div class="grid two-col">
          <div class="card">
            <div class="card-head">
              <div class="card-title">Recommended Session</div>
            </div>
            <div class="card-body" id="detailWorkout"></div>
          </div>

          <div class="card">
            <div class="card-head">
              <div class="card-title">Personal Records</div>
            </div>
            <div class="table-wrap">
              <table class="table" id="detailPRs">
                <thead>
                <tr>
                  <th>Exercise</th>
                  <th>New</th>
                  <th>Prev</th>
                  <th>Date</th>
                </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- TRAIN VIEW -->
    <section class="view" id="view-train">
      <div class="section-head">
        <div>
          <h1 class="page-title">Train</h1>
          <div class="page-sub">Generate sessions and assign load.</div>
        </div>
      </div>

      <div class="grid two-col">
        <div class="card">
          <div class="card-head">
            <div class="card-title">Session Builder</div>
          </div>
          <div class="card-body">
            <div class="form-grid">
              <div>
                <label>Sport</label>
                <select id="buildSport" class="input">
                  <option value="basketball">Basketball</option>
                  <option value="football">Football</option>
                  <option value="soccer">Soccer</option>
                  <option value="baseball">Baseball</option>
                  <option value="volleyball">Volleyball</option>
                  <option value="track">Track</option>
                </select>
              </div>

              <div>
                <label>Type</label>
                <select id="buildType" class="input">
                  <option value="practice">Practice</option>
                  <option value="strength">Strength</option>
                  <option value="speed">Speed</option>
                  <option value="conditioning">Conditioning</option>
                  <option value="recovery">Recovery</option>
                  <option value="competition">Competition</option>
                </select>
              </div>

              <div>
                <label>Duration (min)</label>
                <select id="buildDuration" class="input">
                  <option value="30">30</option>
                  <option value="45">45</option>
                  <option value="60" selected>60</option>
                  <option value="75">75</option>
                  <option value="90">90</option>
                </select>
              </div>

              <div>
                <label>Intensity</label>
                <select id="buildIntensity" class="input">
                  <option value="low">Low</option>
                  <option value="moderate" selected>Moderate</option>
                  <option value="high">High</option>
                </select>
              </div>
            </div>

            <div class="chips-wrap" id="injuryChips">
              <button class="inj-chip" data-injury="knee" type="button">Knee</button>
              <button class="inj-chip" data-injury="ankle" type="button">Ankle</button>
              <button class="inj-chip" data-injury="shoulder" type="button">Shoulder</button>
              <button class="inj-chip" data-injury="back" type="button">Back</button>
              <button class="inj-chip" data-injury="hip" type="button">Hip</button>
              <button class="inj-chip" data-injury="hamstring" type="button">Hamstring</button>
            </div>

            <div style="display:flex;gap:10px;margin-top:12px">
              <button class="btn btn-primary" id="btnGenerate">Generate</button>
              <button class="btn btn-ghost" id="btnPushToday">Push to Today</button>
            </div>

            <div id="generatedSessionWrap" style="margin-top:14px"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Session Library</div>
            <div class="card-actions">
              <button class="btn btn-ghost btn-sm">View all ‚Üí</button>
            </div>
          </div>
          <div class="card-body" id="sessionLibrary"></div>
          <div class="card-foot">
            <button class="btn btn-primary btn-full" id="btnGenerateInline">+ Generate Session</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ANALYTICS VIEW -->
    <section class="view" id="view-analytics">
      <div class="section-head">
        <div>
          <h1 class="page-title">Analytics</h1>
          <div class="page-sub" id="analyticsSub">‚Äî</div>
        </div>
        <div class="actions">
          <button class="btn btn-ghost" id="btnExportAnalytics">Export PDF</button>
        </div>
      </div>

      <div class="grid stats-grid" id="analyticsStatGrid"></div>

      <div class="grid two-col">
        <div class="card">
          <div class="card-head">
            <div class="card-title">Weekly Training Load</div>
          </div>
          <div class="card-body chart" id="loadChart"></div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">PIQ Distribution</div>
          </div>
          <div class="card-body chart" id="scoreDistChart"></div>
          <div class="card-foot" id="scoreRanges"></div>
        </div>
      </div>

      <div class="card">
        <div class="card-head">
          <div class="card-title">Athlete Trends</div>
        </div>
        <div class="table-wrap">
          <table class="table">
            <thead>
            <tr>
              <th>Athlete</th>
              <th>Week Start</th>
              <th>Mid</th>
              <th>Week End</th>
              <th>Current</th>
              <th>Trend</th>
              <th>ACWR</th>
            </tr>
            </thead>
            <tbody id="analyticsBody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- SCHEDULE VIEW -->
    <section class="view" id="view-schedule">
      <div class="section-head">
        <div>
          <h1 class="page-title">Schedule</h1>
          <div class="page-sub">Upcoming events and practices.</div>
        </div>
      </div>

      <div class="card">
        <div class="card-head">
          <div class="card-title">All Events</div>
        </div>
        <div class="card-body" id="fullEventList"></div>
      </div>
    </section>

    <!-- SETTINGS VIEW -->
    <section class="view" id="view-settings">
      <div class="section-head">
        <div>
          <h1 class="page-title">Settings</h1>
          <div class="page-sub">Team, season, theme, and data tools.</div>
        </div>
      </div>

      <div class="grid two-col">
        <div class="card">
          <div class="card-head">
            <div class="card-title">Program Settings</div>
          </div>
          <div class="card-body">
            <div class="form-grid">
              <div>
                <label>Team Name</label>
                <input class="input" id="settingTeamName" placeholder="Team name‚Ä¶" />
              </div>
              <div>
                <label>Season</label>
                <select class="input" id="settingSeason">
                  <option>Pre-Season</option>
                  <option>In-Season</option>
                  <option>Post-Season</option>
                  <option>Off-Season</option>
                </select>
              </div>
              <div>
                <label>Sport</label>
                <select class="input" id="settingSport">
                  <option value="basketball">Basketball</option>
                  <option value="football">Football</option>
                  <option value="soccer">Soccer</option>
                  <option value="baseball">Baseball</option>
                  <option value="volleyball">Volleyball</option>
                  <option value="track">Track</option>
                </select>
              </div>
              <div>
                <label>Theme</label>
                <select class="input" id="settingTheme">
                  <option value="dark">Dark</option>
                  <option value="light">Light</option>
                </select>
              </div>
            </div>

            <div style="display:flex;justify-content:flex-end;margin-top:12px">
              <button class="btn btn-primary" id="btnSaveSettings">Save</button>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-head">
            <div class="card-title">Data Tools</div>
          </div>
          <div class="card-body">
            <button class="btn btn-ghost btn-sm" id="btnExportData">üì¶ Export JSON Backup</button>
            <button class="btn btn-ghost btn-sm" id="btnImportData">üì• Import JSON</button>
            <button class="btn btn-danger btn-sm" id="btnResetData">‚ö† Reset to Demo Data</button>
            <input type="file" id="importFileInput" accept="application/json" style="display:none" />
          </div>
        </div>
      </div>
    </section>

  </main>
</div>

<div class="toast-container" id="toastContainer"></div>

<!-- MAIN APP ENTRY -->
<script type="module" src="./js/app.js"></script>

<!-- Safety: ensure loader never traps UI -->
<script>
  window.addEventListener('load', () => {
    const ls = document.getElementById('loadingScreen');
    if (ls) ls.style.display = 'none';
  });
</script>

</body>
            </html>
