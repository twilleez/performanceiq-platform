/* ============================================================
   styles.css â€” PerformanceIQ v3.7.0
   - Tab indicator glide (desktop + bottom nav)
   - Parallax blur layers
   - Skeleton shimmer for cards
   - Responsive polish
   ============================================================ */

@import url('https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@700;800&family=DM+Sans:wght@400;500;600;700&display=swap');

:root{
  --ok:#22C55E; --warn:#F59E0B; --danger:#EF4444; --info:#3B82F6;

  /* Sport accent (core.js sets these) */
  --accent:#2EC4B6;
  --accent-2: rgba(46,196,182,.14);
  --accent-3: rgba(46,196,182,.28);

  --font-body:"DM Sans",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  --font-head:"Barlow Condensed","DM Sans",system-ui,sans-serif;

  --sp-xs:6px; --sp-sm:10px; --sp-md:14px; --sp-lg:18px;

  --focus-ring:0 0 0 3px color-mix(in oklab, var(--accent) 28%, transparent);

  --ease-out: cubic-bezier(.16, 1, .3, 1);
  --ease-in:  cubic-bezier(.7, 0, .84, 0);

  --select-arrow-light:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%234a5876' d='M1 1l5 5 5-5'/%3E%3C/svg%3E");
  --select-arrow-dark:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%23a9b2c7' d='M1 1l5 5 5-5'/%3E%3C/svg%3E");
  --select-arrow: var(--select-arrow-dark);
}

/* Softer dark theme */
html[data-theme="dark"]{
  --bg:#0b0f16;
  --top:#0e1420;
  --card:#111a28;
  --muted:#b4bed3;
  --line: rgba(255,255,255,.08);
  --text:#e9eef9;
  --input:#0f1726;
  --shadow: 0 18px 54px rgba(0,0,0,.50);
  --optionbg:#0f1726;
  --optionfg:#e9eef9;
  --pillBorder: rgba(255,255,255,.14);
  --activeViewRing: 0 0 0 2px var(--accent-3), 0 18px 60px rgba(0,0,0,.55);
  --select-arrow: var(--select-arrow-dark);
}
html[data-theme="light"]{
  --bg:#f4f7fb;
  --top:#ffffff;
  --card:#ffffff;
  --muted:#3b4b66;
  --line: rgba(15,23,42,.14);
  --text:#0b1220;
  --input:#eef2ff;
  --shadow:0 18px 44px rgba(8,18,40,.10);
  --optionbg:#ffffff;
  --optionfg:#0b1220;
  --pillBorder: rgba(15,23,42,.16);
  --activeViewRing: 0 0 0 2px var(--accent-3), 0 18px 50px rgba(8,18,40,.12);
  --select-arrow: var(--select-arrow-light);
}

/* Reset */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;}
body{
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-body);
  font-variant-numeric: tabular-nums;
  -webkit-text-size-adjust: 100%;
  overflow-x: hidden;
}
:focus-visible{outline:none;box-shadow:var(--focus-ring);}
:focus:not(:focus-visible){outline:none;}

/* =========================
   Parallax blur layers (NEW)
   ========================= */
.piq-parallax{
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  opacity: .85;
  mix-blend-mode: normal;
  filter: saturate(1.05);
}
.piq-parallax .pl{
  position:absolute;
  border-radius: 999px;
  filter: blur(38px);
  opacity: .45;
  transform: translate3d(0,0,0);
  will-change: transform;
}
.piq-parallax .pl.a{
  width: 520px; height: 520px;
  left: -180px; top: -120px;
  background: radial-gradient(circle at 30% 30%,
    color-mix(in oklab, var(--accent) 30%, transparent) 0%,
    transparent 62%);
  transform: translate3d(var(--p1x, 0px), var(--p1y, 0px), 0);
}
.piq-parallax .pl.b{
  width: 620px; height: 620px;
  right: -260px; top: 120px;
  background: radial-gradient(circle at 40% 40%,
    color-mix(in oklab, var(--accent) 22%, transparent) 0%,
    transparent 65%);
  transform: translate3d(var(--p2x, 0px), var(--p2y, 0px), 0);
}
.piq-parallax .pl.c{
  width: 720px; height: 720px;
  left: 18%; bottom: -420px;
  background: radial-gradient(circle at 50% 50%,
    color-mix(in oklab, var(--accent) 18%, transparent) 0%,
    transparent 70%);
  transform: translate3d(var(--p3x, 0px), var(--p3y, 0px), 0);
}

/* Keep app content above parallax */
.topbar, .layout, .bottomnav, .toast, .drawer, .sheet, .splash { position: relative; z-index: 1; }

/* Topbar */
.topbar{
  display:flex;justify-content:space-between;align-items:center;
  padding:12px 20px;
  background: color-mix(in oklab, var(--top) 88%, transparent);
  border-bottom:1px solid var(--line);
  position:sticky;top:0;z-index:10;
  backdrop-filter: blur(14px);
}
.topbar-left{display:flex;align-items:center;flex-wrap:wrap;gap:var(--sp-sm);}
.topbar-right{display:flex;gap:var(--sp-sm);align-items:center;}

.appmark{display:flex;align-items:center;}
.appmark-dot{
  width:10px;height:10px;border-radius:50%;
  background:var(--accent);
  display:inline-block;flex-shrink:0;
  box-shadow:0 0 0 3px color-mix(in oklab, var(--accent) 22%, transparent);
}
.appmark-title{
  font-family:var(--font-head);
  font-weight:800;
  margin-left:8px;
  letter-spacing:.02em;
  font-size:18px;
}

/* Pills */
.pill{
  position: relative; overflow: hidden;
  padding:4px 8px;border-radius:16px;font-size:12px;
  background: transparent;border:1px solid var(--pillBorder);
  display:inline-flex;align-items:center;gap:8px;
  color: color-mix(in oklab, var(--text) 80%, transparent);
  white-space:nowrap;
}
.dot{width:10px;height:10px;border-radius:50%;background:var(--ok);flex-shrink:0;}

/* Layout */
.layout{
  display:flex;
  max-width:1200px;
  margin:18px auto;
  padding:0 16px;
  gap:18px;
}
.nav{width:170px;flex-shrink:0; position: relative; padding-bottom: 6px;}
.content{flex:1;min-width:0;}

/* Desktop nav button */
.navbtn{
  position: relative;
  overflow: hidden;
  display:block;width:100%;
  padding:12px 12px;border-radius:14px;
  border:1px solid transparent;background:none;
  color: color-mix(in oklab, var(--text) 62%, transparent);
  text-align:left;font-weight:900;font-family:inherit;
  cursor:pointer;
  transition: color .18s var(--ease-out), transform .18s var(--ease-out);
}
.navbtn.active{color: var(--text);}
.navbtn:not(.active):hover{color: var(--text); transform: translateY(-1px);}

/* Desktop nav indicator glide (NEW) */
.nav-indicator{
  position:absolute;
  left:0;
  top: 0;
  height: 40px;
  width: 0px;
  border-radius: 14px;
  background: color-mix(in oklab, var(--card) 82%, var(--accent-2));
  border: 1px solid color-mix(in oklab, var(--accent) 26%, var(--pillBorder));
  box-shadow: 0 16px 36px color-mix(in oklab, var(--accent) 10%, transparent);
  transform: translateX(0);
  transition: transform .28s var(--ease-out), width .28s var(--ease-out);
  z-index: 0;
  opacity: 0;
}
.navbtn{ z-index: 1; }
.nav{ display: grid; gap: 8px; }

/* Content views */
.view{scroll-margin-top:84px;}
.view.is-active{box-shadow:var(--activeViewRing);border-radius:18px;}
.view-enter{opacity:0;transform: translateY(12px) scale(.99);filter: blur(8px);}
.view-enter-active{
  opacity:1;transform: translateY(0) scale(1);filter: blur(0);
  transition: opacity .26s var(--ease-out), transform .26s var(--ease-out), filter .26s var(--ease-out);
}
.view-spring{animation: viewSpring .24s var(--ease-out);}
@keyframes viewSpring{
  0%{transform: translateY(0) scale(1);}
  60%{transform: translateY(-2px) scale(1.006);}
  100%{transform: translateY(0) scale(1);}
}

/* Cards */
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:18px;
  padding:var(--sp-md);
  box-shadow:var(--shadow);
  transition: transform .18s var(--ease-out), box-shadow .18s var(--ease-out);
}
.card:hover{transform: translateY(-2px);}
.card-title{font-family:var(--font-head);font-weight:800;letter-spacing:.02em;font-size:20px;}
.subtle{background: color-mix(in oklab, var(--card) 96%, transparent); box-shadow:none;}

.mini{background:transparent;border-radius:10px;padding:8px;}
.minihead{font-weight:900;color: color-mix(in oklab, var(--text) 92%, transparent); margin-bottom:6px; letter-spacing:.02em;}
.minibody{color:var(--muted);}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;}

/* Block cards */
.blockcard{
  margin:10px 0;
  padding:12px;
  border:1px solid var(--line);
  border-radius:16px;
  background: color-mix(in oklab, var(--card) 90%, var(--accent-2));
  box-shadow: 0 16px 38px rgba(0,0,0,.12);
}
.blockcard-head{display:flex;justify-content:space-between;align-items:baseline;gap:10px;margin-bottom:6px;}
.blockcard-title{font-weight:900;letter-spacing:.02em;}

/* Utilities */
.row{display:flex;align-items:center;}
.between{justify-content:space-between;}
.gap{gap:var(--sp-sm);}
.wrap{flex-wrap:wrap;}
.small{font-size:12px;}
.muted{color:var(--muted);}
.hr{height:1px;background:var(--line);margin:12px 0;border-radius:2px;}
.mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;}

/* Buttons */
.btn{
  position: relative;
  overflow: hidden;
  display:inline-flex;align-items:center;justify-content:center;gap:6px;
  padding:12px 12px;border-radius:16px;
  border:1px solid var(--pillBorder);
  background:var(--accent-2);
  color:var(--text);
  font-weight:900;font-family:inherit;line-height:1;
  cursor:pointer;user-select:none;-webkit-user-select:none;
  transition: transform .18s var(--ease-out), filter .18s var(--ease-out), background .18s var(--ease-out);
}
.btn:hover{transform: translateY(-1px); filter: brightness(1.04);}
.btn:active{transform: translateY(0); filter: brightness(0.96);}
.btn.ghost{background:transparent;}
.btn.danger{background: rgba(239,68,68,.14); border-color: rgba(239,68,68,.35);}
.btn:disabled,.btn[aria-disabled="true"]{opacity:.45;cursor:not-allowed;pointer-events:none;}

html[data-theme="light"] .btn:not(.ghost):not(.danger){
  background:var(--accent);
  border-color:transparent;
  color:#fff;
  box-shadow: 0 18px 40px color-mix(in oklab, var(--accent) 20%, transparent);
}
html[data-theme="light"] .btn.ghost{border-color: var(--line);}

/* Icon buttons */
.iconbtn{
  position: relative; overflow: hidden;
  width:28px;height:28px;border-radius:10px;
  border:1px solid var(--pillBorder);
  background:transparent;
  color: color-mix(in oklab, var(--text) 86%, transparent);
  font-weight:900;font-family:inherit;
  cursor:pointer;display:inline-flex;align-items:center;justify-content:center;flex-shrink:0;
  transition: background .18s var(--ease-out), transform .18s var(--ease-out);
}
.iconbtn:hover{background: color-mix(in oklab, var(--card) 84%, var(--accent-2)); transform: translateY(-1px);}

/* Forms */
.field label{
  display:block;font-size:12px;
  color: color-mix(in oklab, var(--text) 70%, transparent);
  margin-bottom:6px;font-weight:900;
}
.field input[type="text"], .field input[type="email"], .field input[type="number"],
.field input[type="password"], .field input[type="search"], .field input[type="date"],
.field select, .field textarea{
  width:100%;
  padding:12px;
  border-radius:16px;
  border:1px solid var(--pillBorder);
  background:var(--input);
  color:var(--text);
  font-family:inherit;
  outline:none;appearance:none;-webkit-appearance:none;
  transition: border-color .18s var(--ease-out), box-shadow .18s var(--ease-out);
}
.field input::placeholder{color: color-mix(in oklab, var(--text) 52%, transparent);}
.field input:focus,.field select:focus,.field textarea:focus{border-color:var(--accent);box-shadow:var(--focus-ring);}

.field select{
  background-image: var(--select-arrow);
  background-repeat:no-repeat;
  background-position:right 12px center;
  padding-right:30px;
}
.field select option{background:var(--optionbg);color:var(--optionfg);}
.field textarea{min-height:80px;resize:vertical;}

/* Drawer */
.drawer{
  position:fixed;right:0;top:0;height:100%;width:390px;
  background:var(--top);
  border-left:1px solid var(--line);
  padding:12px;
  transform: translateX(100%);
  transition: transform .28s var(--ease-out);
  z-index:120;
  overflow-y:auto;-webkit-overflow-scrolling:touch;
  overscroll-behavior:contain;
  backdrop-filter: blur(14px);
}
.drawer.open{transform:translateX(0);}
.drawer-backdrop{
  position:fixed;inset:0;
  background: rgba(2,6,12,.55);
  z-index:110;
  backdrop-filter: blur(10px);
}
.drawer-head{
  display:flex;justify-content:space-between;align-items:center;
  gap:var(--sp-sm);
  padding:6px 4px var(--sp-sm);
  border-bottom:1px solid var(--line);
}
.drawer-title{font-family:var(--font-head);font-weight:800;letter-spacing:.02em;}
.drawer-body{padding:var(--sp-sm) 4px;}
.drawer-help{width:420px;}

/* Toast */
.toast{
  position:fixed;left:50%;transform:translateX(-50%);
  bottom:28px;
  background: color-mix(in oklab, var(--top) 88%, transparent);
  padding:12px 14px;
  border-radius:16px;
  border:1px solid var(--line);
  box-shadow:var(--shadow);
  z-index:200;
  font-size:13px;
  white-space:nowrap;
  max-width: calc(100vw - 32px);
  overflow:hidden;text-overflow:ellipsis;
  backdrop-filter: blur(14px);
}

/* FAB + Sheet */
.fab{
  position:fixed;right:18px;bottom:84px;z-index:140;
  width:56px;height:56px;border-radius:20px;
  border:1px solid var(--pillBorder);
  background: var(--accent-2);
  color: var(--text);
  font-size:26px;font-weight:900;
  box-shadow:var(--shadow);
  cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition: transform .18s var(--ease-out), filter .18s var(--ease-out);
}
.fab:hover{transform: translateY(-2px); filter: brightness(1.06);}
html[data-theme="light"] .fab{
  background:var(--accent); color:#fff; border-color:transparent;
  box-shadow: 0 18px 40px color-mix(in oklab, var(--accent) 22%, transparent);
}

.sheet-backdrop{position:fixed;inset:0;background: rgba(2,6,12,.55);z-index:130;backdrop-filter: blur(10px);}
.sheet{
  position:fixed;left:50%;transform: translateX(-50%);
  bottom:18px;z-index:140;
  width:min(520px,94vw);
  border:1px solid var(--line);
  background: var(--top);
  border-radius:18px;
  box-shadow: var(--shadow);
  overflow:hidden;
  backdrop-filter: blur(14px);
}
.sheet-head{display:flex;justify-content:space-between;align-items:center;padding:12px var(--sp-md);border-bottom:1px solid var(--line);}
.sheet-title{font-family:var(--font-head);font-weight:800;letter-spacing:.02em;}
.sheet-body{padding:12px var(--sp-md);display:grid;gap:var(--sp-sm);}

/* Bottom nav */
.bottomnav{
  position:fixed;left:0;right:0;bottom:0;
  background: color-mix(in oklab, var(--top) 88%, transparent);
  border-top:1px solid var(--line);
  display:flex;justify-content:space-around;
  z-index:100;
  padding-bottom: env(safe-area-inset-bottom, 0px);
  backdrop-filter: blur(14px);
}
.tab{
  position:relative;
  overflow:hidden;
  padding:12px var(--sp-sm);
  border:none;background:none;
  color: color-mix(in oklab, var(--text) 60%, transparent);
  font-weight:900;font-family:inherit;
  cursor:pointer;flex:1;
  transition: color .18s var(--ease-out), transform .18s var(--ease-out);
}
.tab.active{color:var(--text);}
.tab:active{transform: translateY(1px);}

/* Bottom indicator glide (NEW) */
.bottom-indicator{
  position:absolute;
  left:0;
  bottom:6px;
  height:3px;
  width:0px;
  border-radius:999px;
  background: var(--accent);
  box-shadow: 0 10px 22px color-mix(in oklab, var(--accent) 22%, transparent);
  transform: translateX(0);
  transition: transform .28s var(--ease-out), width .28s var(--ease-out);
  opacity: 0;
  pointer-events:none;
}

/* Splash (kept compatible) */
.splash{
  position:fixed;inset:0;
  display:flex;align-items:center;justify-content:center;
  background:
    radial-gradient(circle at top, color-mix(in oklab, var(--accent) 22%, transparent), transparent 45%),
    var(--top);
  z-index:300;
  transition: opacity .25s var(--ease-out);
}
.splash.hidden{opacity:0;pointer-events:none;}
.splash-card{
  width:min(520px,92vw);
  background: var(--top);
  border:1px solid var(--line);
  border-radius:18px;
  padding:var(--sp-lg);
  box-shadow: var(--shadow);
}

/* Ripple */
.ripple-host { position: relative; overflow: hidden; }
.ripple{
  position:absolute;
  border-radius:999px;
  pointer-events:none;
  transform: scale(0);
  opacity: .22;
  background: radial-gradient(circle,
    color-mix(in oklab, var(--accent) 35%, transparent) 0%,
    color-mix(in oklab, var(--accent) 18%, transparent) 40%,
    transparent 70%);
  animation: ripple .52s var(--ease-out) forwards;
}
@keyframes ripple{
  0%{transform: scale(.12); opacity: .22;}
  100%{transform: scale(1); opacity: 0;}
}

/* Spring press */
.spring-press{ animation: pressSpring .26s var(--ease-out); }
@keyframes pressSpring{
  0%{transform: translateY(0) scale(1);}
  40%{transform: translateY(1px) scale(.985);}
  100%{transform: translateY(0) scale(1);}
}

/* Score ring */
.piq-score-ring{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:12px;border-radius:18px;border:1px solid var(--line);
  background: color-mix(in oklab, var(--card) 86%, var(--accent-2));
  box-shadow: 0 18px 44px rgba(0,0,0,.14);
}
.ring-wrap{position:relative;width:120px;height:120px;border-radius:999px;}
.ring{width:120px;height:120px;transform: rotate(-90deg);display:block;}
.ring-bg{fill:none;stroke: color-mix(in oklab, var(--text) 12%, transparent);stroke-width: 12;}
.ring-prog{
  fill:none;stroke: var(--accent);stroke-width: 12;stroke-linecap: round;
  stroke-dasharray: 0;stroke-dashoffset: 0;
  transition: stroke-dashoffset .75s var(--ease-out);
}
.ring-prog.ring-anim{transition: stroke-dashoffset .75s var(--ease-out);}
.ring-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;pointer-events:none;}
.piq-score-num{font-family: var(--font-head);font-weight: 800;font-size: 34px;line-height: 1;letter-spacing: .02em;color: var(--text);}
.piq-score-sub{font-size: 12px;color: var(--muted);font-weight: 900;}
.piq-score-side{display:grid;gap:6px;align-content:start;}
.piq-score-chip{
  display:inline-flex;align-items:center;justify-content:center;width:fit-content;
  font-size: 12px;font-weight: 900;padding: 5px 10px;border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--accent) 30%, var(--line));
  background: color-mix(in oklab, var(--accent) 16%, transparent);
  color: color-mix(in oklab, var(--text) 90%, transparent);
}
.score-bump{ animation: scoreBump .40s var(--ease-out); }
@keyframes scoreBump{
  0%{transform: scale(1);}
  50%{transform: scale(1.04);}
  100%{transform: scale(1);}
}

/* =========================
   Skeleton shimmer (NEW)
   ========================= */
.sk-wrap{padding: 4px;}
.sk-card{
  border-radius: 18px;
  border: 1px solid var(--line);
  background: color-mix(in oklab, var(--card) 92%, transparent);
  box-shadow: 0 18px 44px rgba(0,0,0,.10);
  padding: 14px;
  overflow: hidden;
  position: relative;
}
.sk-head{
  height: 16px;
  width: 62%;
  border-radius: 999px;
  background: color-mix(in oklab, var(--text) 10%, transparent);
  margin-bottom: 12px;
}
.sk-line{
  height: 12px;
  width: 100%;
  border-radius: 999px;
  background: color-mix(in oklab, var(--text) 8%, transparent);
  margin-top: 10px;
}
.sk-line:nth-child(3){width: 86%;}
.sk-line:nth-child(4){width: 72%;}
.sk-line:nth-child(5){width: 92%;}
.sk-line:nth-child(6){width: 64%;}
.sk-line:nth-child(7){width: 78%;}
.sk-line:nth-child(8){width: 58%;}
.sk-card::after{
  content:"";
  position:absolute;
  inset:-40% -60%;
  background: linear-gradient(90deg,
    transparent 0%,
    color-mix(in oklab, var(--accent) 10%, transparent) 45%,
    color-mix(in oklab, var(--text) 14%, transparent) 55%,
    transparent 100%);
  transform: translateX(-40%);
  animation: skShimmer 1.25s linear infinite;
  opacity: .75;
}
@keyframes skShimmer{
  0%{transform: translateX(-40%) rotate(10deg);}
  100%{transform: translateX(70%) rotate(10deg);}
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .btn,.navbtn,.tab,.drawer,.fab,.iconbtn,.splash,.view-enter-active,.card,.score-bump,.spring-press,.ripple,.view-spring,
  .sk-card::after, .nav-indicator, .bottom-indicator{
    transition:none !important;
    animation:none !important;
  }
  .piq-parallax{display:none !important;}
}

/* Responsive */
@media (max-width: 980px){
  .layout{max-width: 980px;}
}
@media (max-width: 860px){
  .layout{
    flex-direction:column;
    margin:10px auto;
    padding:12px;
    padding-bottom: calc(78px + env(safe-area-inset-bottom, 0px));
    gap: 14px;
  }
  .nav{
    display:flex;
    gap:8px;
    overflow-x:auto;
    scrollbar-width:none;
    width:auto;
    padding-bottom: 0;
  }
  .nav::-webkit-scrollbar{display:none;}
  .navbtn{white-space:nowrap;flex-shrink:0;}
  .nav-indicator{display:none;} /* bottom indicator handles mobile */
  .grid2{grid-template-columns:1fr;}
  .drawer,.drawer-help{width:min(92vw,420px);}
  .piq-score-ring{gap: 10px;}
}
@media (max-width: 420px){
  .topbar{padding: 10px 12px;}
  .appmark-title{font-size: 16px;}
  .pill{font-size: 11px;}
  .ring-wrap{width:110px;height:110px;}
  .ring{width:110px;height:110px;}
    }
